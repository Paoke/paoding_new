$(function(){var e={tip_ct:"",tip_url:""};var a={addtips:function(g,i){var h='<div class="tipCommon" style="display:block">'+g+"</div>";$("body").append(h);setTimeout(function(){$(".tipCommon").remove();if(i){window.location.href=i}},1500)}};"use strict";var b=window.console||{log:function(){}},d=$(".docs-alert"),c=d.find(".message"),f=function(h,g){c.text(h);if(g){c.addClass(g)}d.fadeIn();setTimeout(function(){d.fadeOut()},3000)};(function(){var h=$(".img-container > img"),m=$("#dataX"),k=$("#dataY"),j=$("#dataHeight"),g=$("#dataWidth"),o=$("#dataRotate"),p={aspectRatio:1/1,preview:".img-preview",crop:function(q){m.val(Math.round(q.x));k.val(Math.round(q.y));j.val(Math.round(q.height));g.val(Math.round(q.width));o.val(Math.round(q.rotate))}};h.on({"build.cropper":function(q){b.log(q.type)},"built.cropper":function(q){b.log(q.type)},"dragstart.cropper":function(q){b.log(q.type,q.dragType)},"dragmove.cropper":function(q){b.log(q.type,q.dragType)},"dragend.cropper":function(q){b.log(q.type,q.dragType)},"zoomin.cropper":function(q){b.log(q.type)},"zoomout.cropper":function(q){b.log(q.type)}}).cropper(p);$(document.body).on("click","[data-method]",function(){var s=$(this).data(),r,q;if(s.method){s=$.extend({},s);if(typeof s.target!=="undefined"){r=$(s.target);if(typeof s.option==="undefined"){try{s.option=JSON.parse(r.val())}catch(u){b.log(u.message)}}}q=h.cropper(s.method,s.option);if(s.method==="getCroppedCanvas"){var t=q.toDataURL("image/jpeg");if(t!=""){var s={head_pic:t};$.post("/api.php/User/user_info/action/update_head",s,function(v){if(v!=false){tip_ct="上传成功";tip_url="/index.php/Mobile/User/user_center";a.addtips(tip_ct,tip_url)}else{tip_ct="上传失败";a.addtips(tip_ct)}},"json")}}if($.isPlainObject(q)&&r){try{r.val(JSON.stringify(q))}catch(u){b.log(u.message)}}}}).on("keydown",function(q){switch(q.which){case 37:q.preventDefault();h.cropper("move",-1,0);break;case 38:q.preventDefault();h.cropper("move",0,-1);break;case 39:q.preventDefault();h.cropper("move",1,0);break;case 40:q.preventDefault();h.cropper("move",0,1);break}});var i=$("#inputImage"),n=window.URL||window.webkitURL,l;if(n){i.change(function(){var r=this.files,q;if(r&&r.length){q=r[0];l=n.createObjectURL(q);h.one("built.cropper",function(){n.revokeObjectURL(l)}).cropper("reset",true).cropper("replace",l);i.val("")}})}else{i.parent().remove()}$(".docs-options :checkbox").on("change",function(){var q=$(this);p[q.val()]=q.prop("checked");h.cropper("destroy").cropper(p)});$('[data-toggle="tooltip"]').tooltip()}())});function timer(a){var b=setInterval(function(){$(".tip").hide();clearInterval(b);if(a==""||a==null){}else{window.location.href=a}},1000)};